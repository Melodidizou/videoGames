
//Definition des textes
var text1 = "Maintenant, appuyer sur les touches de votre \n   clavier pour faire chanter Julie Andrews";
var text2 = "Appuyer sur les touches de votre clavier     \n        pour faire chanter les enfants";
var text3 = "Appuies pour chanter tous ensembles";
var text4 = "Appuies pour chanter des paroles";
var text5 = "Debout! Lève toi et chantes !";

//Définition des transitions flags

var next_1 = "015";
var next_2 = "030";
var next_3 = "045";
var next_4 = "060";

var compteur = 0;
var maxCpt = 16;
var minVideo,maxVideo;

//Transitions - changement de vidéo par touches
function keypressActivate(e){
    if(maxCpt && (compteur > maxCpt)){
      if(next_1){ changeVideo(next_1); }
      else if(next_2){ changeVideo(next_2); }
      else if(next_3){ changeVideo(next_3); }
      else if(next_4){ changeVideo(next_4); }
      if(next_1 || next_2 || next_3 || next_4){
        $(document).unbind('keypress');
        return;
      }
    }
    var code = e.keyCode || e.which;
    if(mappedKeyboard[code] == undefined){
      var randkey = Math.floor(Math.random() * (maxVideo-minVideo)) + minVideo;
      console.log(randkey.zeroPad(100));
      changeVideo(randkey.zeroPad(100));
      compteur++;
    }else{
      changeVideo(mappedKeyboard[code].zeroPad(100));
      compteur++;
    }
}

// Gestion de l'assigmenent des vidéo clefs par evennement
$(document).ready(function(){
    $('#video_000').on('ended',function(){
      loadText(text1,false);
      minVideo=1;
      maxVideo=14;
      mappedKeyboard = createMappedKeyboard(minVideo,maxVideo,false);
      $(document).bind('keypress', "e", keypressActivate);
    });
    $('#video_015').on('ended',function(){
      loadText(text2,false);
      compteur = 0;
      next_1 = false;
      minVideo=16;
      maxVideo=29;
      mappedKeyboard = createMappedKeyboard(minVideo,maxVideo,false);
      $(document).bind('keypress', "e", keypressActivate);
    });
    $('#video_030').on('ended',function(){
      loadText(text3,false);
      compteur = 0;
      next_2 = false;
      minVideo=31;
      maxVideo=44;
      mappedKeyboard = createMappedKeyboard(minVideo,maxVideo,false);
      $(document).bind('keypress', "e", keypressActivate);
    });
    $('#video_045').on('ended',function(){
      loadText(text4,false);
      compteur = 0;
      next_3 = false;
      minVideo=46;
      maxVideo=59;
      mappedKeyboard = createMappedKeyboard(minVideo,maxVideo,false);
      $(document).bind('keypress', "e", keypressActivate);
    });
    $('#video_060').on('ended',function(){
      loadText(text5,false);
      compteur = 0;
      next_4 = false;
      minVideo=61;
      maxVideo=74;
      mappedKeyboard = createMappedKeyboard(minVideo,maxVideo,false);
      $(document).bind('keypress', "e", keypressActivate);
    });
  });
