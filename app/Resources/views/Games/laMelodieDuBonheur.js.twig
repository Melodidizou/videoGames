
//Definition des textes
var text1 = "";
var text2 = "";
var text3 = "";
var text4 = "";
var text5 = "";

//Définition des transitions flags

var next_1 = "015";
var next_2 = "030";
var next_3 = "045";
var next_4 = "060";

var compteur = 0;
var maxCpt = 16;
var minVideo,maxVideo;
var delayMsg = 'infini';

//Transitions - changement de vidéo par touches
function keypressActivate(e){
    if(maxCpt && (compteur > maxCpt)){
      if(next_1){ loadText("",0); changeVideo(next_1,delayMsg); }
      else if(next_2){ loadText("",0); changeVideo(next_2,delayMsg); }
      else if(next_3){ loadText("",0); changeVideo(next_3,delayMsg); }
      else if(next_4){ loadText("",0); changeVideo(next_4,delayMsg); }
      if(next_1 || next_2 || next_3 || next_4){
        $(document).unbind('keypress');
        return;
      }
    }
    var code = e.keyCode || e.which;
    if(mappedKeyboard[code] == undefined){
      var randkey = Math.floor(Math.random() * (maxVideo-minVideo)) + minVideo;
      changeVideo(randkey.zeroPad(100),delayMsg);
      compteur++;
    }else{
      changeVideo(mappedKeyboard[code].zeroPad(100),delayMsg);
      compteur++;
    }
    $('.reste').text(maxCpt-(compteur));
}

// Gestion de l'assigmenent des vidéo clefs par evennement
$(document).ready(function(){
    $('#video_000').on('ended',function(){
      loadText(text1,delayMsg);
      minVideo=1;
      maxVideo=14;
      mappedKeyboard = createMappedKeyboard(minVideo,maxVideo,false);
      $(document).bind('keypress', "e", keypressActivate);
    });
    $('#video_015').on('ended',function(){
      loadText(text2,delayMsg);
      compteur = 0;
      next_1 = false;
      minVideo=16;
      maxVideo=29;
      mappedKeyboard = createMappedKeyboard(minVideo,maxVideo,false);
      $(document).bind('keypress', "e", keypressActivate);
    });
    $('#video_030').on('ended',function(){
      loadText(text3,delayMsg);
      compteur = 0;
      next_2 = false;
      minVideo=31;
      maxVideo=44;
      mappedKeyboard = createMappedKeyboard(minVideo,maxVideo,false);
      $(document).bind('keypress', "e", keypressActivate);
    });
    $('#video_045').on('ended',function(){
      loadText(text4,delayMsg);
      compteur = 0;
      next_3 = false;
      minVideo=46;
      maxVideo=59;
      mappedKeyboard = createMappedKeyboard(minVideo,maxVideo,false);
      $(document).bind('keypress', "e", keypressActivate);
    });
    $('#video_060').on('ended',function(){
      loadText(text5,delayMsg);
      compteur = 0;
      next_4 = false;
      minVideo=61;
      maxVideo=74;
      mappedKeyboard = createMappedKeyboard(minVideo,maxVideo,false);
      $(document).bind('keypress', "e", keypressActivate);
    });
  });
